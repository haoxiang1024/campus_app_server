<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>校园失物招领后台</title>
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/all.min.css" rel="stylesheet">
    <link href="./css/sweetalert2.min.css" rel="stylesheet">

    <style>

        :root { --sky-blue: #00aaff; --bg-color: #f0f8ff; --sidebar-dark: #2c3e50; }
        body { font-size: .875rem; background-color: var(--bg-color); overflow-x: hidden; }
        .navbar { background: #fff !important; border-bottom: 2px solid var(--sky-blue); height: 56px; z-index: 1001; }
        .navbar-brand { color: var(--sky-blue) !important; font-weight: bold; }
        .sidebar { position: fixed; top: 0; bottom: 0; left: 0; width: 240px; padding-top: 56px; background: var(--sidebar-dark); z-index: 1000; }
        .sidebar .nav-link { color: #bdc3c7; margin: 5px 15px; border-radius: 8px; padding: 10px 15px; cursor: pointer; }
        .sidebar .nav-link.active { background: var(--sky-blue); color: #fff !important; }
        .main-content { margin-left: 240px; padding: 25px; width: calc(100% - 240px); box-sizing: border-box; min-height: 100vh; }
    </style>
</head>
<body>

<script>
    // 权限与用户名检查
    (function() {
        const data = sessionStorage.getItem("admin");
        if (!data) { window.location.href = 'login.html'; return; }
        const admin = JSON.parse(data);
        const check = setInterval(function() {
            const el = document.getElementById('adminName');
            if (el) { el.textContent = admin.username; clearInterval(check); }
        }, 5);
    })();
</script>

<header class="navbar navbar-expand-md sticky-top shadow-sm">
    <a class="navbar-brand px-4" href="#"><i class="fa fa-paper-plane me-2"></i>校园失物招领管理后台</a>
    <div class="navbar-nav ms-auto align-items-center">
        <span class="nav-link text-dark fw-bold me-4" >用户名:</span>
        <span class="nav-link text-dark fw-bold me-4" id="adminName"></span>
        <a class="btn btn-outline-danger btn-sm me-3" href="#" onclick="logout()"><i class="fa fa-sign-out-alt"></i> 退出</a>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <nav class="sidebar">
            <ul class="nav flex-column mt-3">
                <li class="nav-item"><a class="nav-link active" data-page="statistics.html"><i class="fa fa-chart-pie me-2"></i> 数据统计</a></li>
                <li class="nav-item"><a class="nav-link" data-page="user_manage.html"><i class="fa fa-user-friends me-2"></i> 用户管理</a></li>
                <li class="nav-item"><a class="nav-link" data-page="lost_manage.html"><i class="fa fa-search-minus me-2"></i> 失物管理</a></li>
                <li class="nav-item"><a class="nav-link" data-page="found_manage.html"><i class="fa fa-hand-holding-heart me-2"></i> 招领管理</a></li>
            </ul>
        </nav>

        <main class="main-content" id="displayArea">
        </main>
    </div>
</div>

<script src="./js/jquery.min.js"></script>
<script src="./js/bootstrap.bundle.min.js"></script>
<script src="./js/sweetalert2@11.js"></script>

<script>
    $(function() {
        // 初始加载默认页
        loadContent('statistics.html');

        // 点击侧边栏切换
        $('.sidebar .nav-link').click(function() {
            const page = $(this).attr('data-page');
            $('.sidebar .nav-link').removeClass('active');
            $(this).addClass('active');
            loadContent(page);
        });
    });

    // 核心加载函数
    function loadContent(pageName) {
        // 使用 jQuery 的 load 方法动态加载 HTML 片段
        $('#displayArea').load(pageName, function(response, status, xhr) {
            if (status === "error") {
                $('#displayArea').html('<div class="alert alert-danger">页面加载失败: ' + xhr.status + " " + xhr.statusText + '</div>');
            }
        });
    }

    function logout() {
        // 美化弹窗工具封装
        const Toast = {
            // 成功提示（右上角自动消失）
            success: (msg) => {
                Swal.fire({
                    icon: 'success',
                    title: msg,
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 2000,
                    width: '220px', // 强制宽度
                    padding: '0.5rem', // 极简内边距
                });
            },
            // 错误/失败提示（中间弹窗）
            error: (msg) => {
                Swal.fire({
                    icon: 'error',
                    title: '操作失败',
                    text: msg,
                    confirmButtonColor: '#00aaff',
                    width: '320px', // 锁定宽度，不再显得巨大
                    padding: '1.25rem',
                    customClass: {
                        title: 'fs-6', // 使用 Bootstrap 字体类缩小标题
                        htmlContainer: 'small' // 缩小内容字体
                    }
                });
            },
            // 确认对话框
            confirm: (title, text, callback) => {
                Swal.fire({
                    title: title,
                    text: text,
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#00aaff',
                    cancelButtonColor: '#6c757d',
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    width: '350px', // 确认框稍宽一点点以便容纳两个按钮
                    padding: '1.25rem',
                    customClass: {
                        title: 'fs-6',
                        htmlContainer: 'small'
                    }
                }).then((result) => {
                    if (result.isConfirmed) callback();
                });
            }
        };

// 修改后的退出逻辑
        Toast.confirm('确定退出吗？', '您的会话将被清除', () => {
            sessionStorage.clear();
            window.location.href = 'login.html';
        });    }
</script>
</body>
</html>